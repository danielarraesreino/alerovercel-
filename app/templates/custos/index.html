{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Custos Fixos & Investimentos</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <a href="{{ url_for('custos.criar') }}" class="btn btn-sm btn-outline-primary mr-2">
            <i class="fas fa-plus"></i> Novo Custo
        </a>
        <a href="{{ url_for('custos.rateio') }}" class="btn btn-sm btn-outline-success">
            <i class="fas fa-calculator"></i> Rateio para Pratos
        </a>
    </div>
</div>

<div class="card mb-4">
    <div class="card-body">
        <form method="get" class="form-inline">
            <label class="mr-2">Mês:</label>
            <select name="mes" class="form-control mr-2">
                {% for m in range(1, 13) %}
                <option value="{{ m }}" {% if m==mes %}selected{% endif %}>{{ m }}</option>
                {% endfor %}
            </select>

            <label class="mr-2">Ano:</label>
            <select name="ano" class="form-control mr-2">
                <option value="{{ ano }}" selected>{{ ano }}</option>
                <option value="{{ ano-1 }}">{{ ano-1 }}</option>
            </select>

            <button type="submit" class="btn btn-primary">Filtrar</button>
        </form>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th>Descrição</th>
                <th>Tipo</th>
                <th>Data Ref.</th>
                <th>Valor</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for custo in custos %}
            <tr>
                <td>{{ custo.descricao }}</td>
                <td>{{ custo.tipo }}</td>
                <td>{{ custo.data_referencia.strftime('%m/%Y') }}</td>
                <td>R$ {{ "%.2f"|format(custo.valor) }}</td>
                <td>
                    <a href="{{ url_for('custos.excluir', id=custo.id) }}" class="btn btn-sm btn-danger"
                        onclick="return confirm('Tem certeza?')">
                        <i class="fas fa-trash"></i>
                    </a>
                </td>
            </tr>
            {% endfor %}
            <tr class="font-weight-bold">
                <td colspan="3" class="text-right">Total:</td>
                <td colspan="2">R$ {{ "%.2f"|format(total) }}</td>
            </tr>
        </tbody>
    </table>
</div>
{% endblock %}